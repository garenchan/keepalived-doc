负载均衡技术
^^^^^^^^^^^^

基于NAT的虚拟服务器(VS/NAT)
---------------------------

当负载均衡器（或LVS路由器）具有两个网络接口卡（``NIC``）时，使用``NAT``路由，一个接口卡分配面向外部的IP地址，另一个分配私有的面向内部的IP地址。\
在此方法中，负载均衡器接收来自公共网络上的用户请求，并使用网络地址转换（NAT）将这些请求转发到位于专用网络上的真实服务器。当真实服务器响应用户的请求时，响应也会进行反向转换。

因此，带来的一个优点是真实服务器隐藏在负载均衡器后面而不受到公共网络的影响。另一个优点是IP地址保留，因为专用网络可以使用私有地址范围。

主要缺点是负载均衡器成为了瓶颈。它不仅要服务还要响应来自公共网络的用户请求，同时还要向私有的真实服务器进行转发。


基于隧道的虚拟服务器(VS/TUN)
----------------------------

待补充


基于直接路由的虚拟服务器(VS/DR)
-------------------------------

在直接路由中，用户向负载均衡器上的 ``VIP`` 发出请求。负载均衡器使用其预定义的调度（分配）算法将请求转发到适当的真实服务器。\
与使用NAT路由不同，真实服务器直接将响应发送到公共用户，绕过了通过负载均衡器路由的需要。

此路由方法的主要优点是可扩展性，因为负载均衡器不承担将真实服务器的响应数据包路由到公共用户的额外责任。

这种路由方法的缺点在于其ARP限制。为了使真实服务器直接响应公共用户的请求，每个真实服务器在发送响应时必须使用VIP作为其源地址。\
因此，VIP和MAC地址的组合在负载均衡器和每个真实服务器之间共享，这可能导致真实服务器直接接收请求，绕过传入请求的负载均衡器。\
有一些方法可以解决这个问题，但代价是增加了配置的复杂性和可管理性。
